{% include 'base.html' %}
{% block gruposlist  %} 
{% load staticfiles %}
{% include 'navbar.html' %}
<div class="container-fluid page-body-wrapper">
  {% include 'sidebar.html' %}
<div class="main-panel">
  <div class="content-wrapper">
    <div class="page-header">
      <h3 class="page-title">Asignacion de grupos</h3>
      <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
          <li class="breadcrumb-item active"><a href="{% url 'index' %}">Inicio</a></li>
          <li class="breadcrumb-item"><a href="{% url 'grupo_list' %}">Listado de grupos</a></li>
        </ol>
      </nav>
    </div>
    <!-- Modal / Ventana / Overlay en HTML -->
    
    <div class="col-lg-12 grid-margin stretch-card">
      <div class="card">
        <div class="card-body">
          <span class="d-flex align-items-center purchase-popup">
            <h4 class="card-title">Grupos Asignados</h4>
            <button type="button" class="btn download-button purchase-button btn-rounded ml-auto" >
              <a class="color-white" href="{% url 'grupo_add' %}">Agregar Grupos</a>
              </button>
        </span>
          <table class="table table-striped">
            <thead>
              <tr>
                <th>No. </th>
                <th>Nombre del grupo</th>
                <th>Integrantes</th>
                <th>Directiva</th>
                <th>Acciones</th>

              </tr>
            </thead>
            <tbody>
              {% for grupo in grupo_list %}

              <tr>
                <td>{{forloop.counter}}</td>
                <td>{{grupo.nombre_grupo }}</td>
                <td>{{6}}</td> 
                <td>
                  <a type="button" class="btn btn-sm btn-info btn-rounded btn-fw" href="/grupos/directiva/{{ grupo.id }} ">Directiva</a>
                </td>
                <td>
                  <button type="button" id="user-delete" class="bs-modal btn btn-sm btn-warning" data-form-url="{% url 'grupo_update' grupo.id %}">
                      <span class="fa fa-trash">Editar</span>
                  </button>
                  <a type="button" class="btn btn-sm btn-success" href="{% url 'pergrup_add' id=grupo.id %}">Integrantes</a>
                  <a type="button" class="btn btn-sm btn-danger" href="#" onclick="eliminar_grupo({{grupo.id}})">Eliminar</a>
                </td>
              </tr>
              {% endfor %} 
            </tbody>
          </table>
          <div class="modal fade" tabindex="-1" role="dialog" id="modal">
              <div class="modal-dialog modal-lg" role="document">
                <div class="modal-content"></div>
              </div>
            </div>
       
            <script type="text/javascript">
              $(function () {
                // Update, Read and Delete book buttons open modal with id="modal" (default)
                // The formURL is retrieved from the data of the element
                $(".bs-modal").each(function () {
                  $(this).modalForm({
                    formURL: $(this).data('form-url')
                  });
                });
              });
            </script>
        </div>
      </div>
    </div>
  </div>
</div>
</div>

{% block js %}
<script>
  function eliminar_grupo(id){
    console.log(id)
    Swal.fire({
      title: 'Desea eliminar el grupo?',
      icon: 'warning',
      showCancelButton: true,
      confirmButtonColor: '#3085d6',
      cancelButtonColor: '#d33',
      cancelButtonText: 'Cancelar',
      confirmButtonText: 'Eliminar'
    })
    .then((result) => {
      if (result.isConfirmed) {
        window.location.href ="/grupos-delete/"+id
        Swal.fire({
          title: 'Grupo eliminado correctamente',
          icon: 'success',
        }
        )
      }
    })
  }
</script>
  
{% endblock %}
{% endblock gruposlist %}